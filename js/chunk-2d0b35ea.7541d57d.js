(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b35ea"],{"27a0":function(t,e,n){"use strict";n.r(e);var a,s=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("notify",{ref:"notify"}),n("section",{staticClass:"main"},[n("a",{staticClass:"farms-back",on:{click:function(e){return t.$router.back()}}},[n("i",{staticClass:"ico ico-alone-left"}),t._v(t._s(t.$t("返回")))]),n("div",{staticClass:"info"},[n("u"),n("u"),n("li",[n("h5",[t._v(t._s(t.$t("收益")))]),n("div",{staticClass:"flex flex-column flex-sub"},[n("span",[n("em",[t._v(t._s(t._f("toFixed")(t._f("toAmount")(t.mgpIncome),8))+" MGP")])]),n("span",[n("em",[t._v(t._s(t._f("toFixed")(t._f("toAmount")(t.mastIncome),8))+" MAST")])])]),n("a",{staticClass:"btn",on:{click:t.claim}},[n("s"),n("s"),t._v(t._s(t.$t("领取")))])]),n("li",[n("h5",[t._v(t._s(t.$t("总质押")))]),n("span",[n("em",[t._v(t._s(t._f("toFixed")(t.withdrawAmount,8))+" "+t._s("xmast"===t.stakeToken?"XMAST":"MAST-MGP-LP"))])])])]),n("div",{staticClass:"contant"},[n("div",{staticClass:"form form-stake"},[n("li",[n("h5",[t._v(t._s(t.$t("质押")))]),n("em",[t._v(t._s(t.$t("余额"))+" "+t._s(t.balance)+" "+t._s("xmast"===t.stakeToken?"XMAST":"MAST-MGP-LP"))])]),n("li",{staticClass:"form-stake"},[n("i",{staticClass:"ico-coin-scepter"}),"lp"===t.stakeToken?n("i",{staticClass:"ico-coin-mgp"}):t._e(),n("input",{attrs:{type:"text"},domProps:{value:t.inputAmount},on:{input:t.updateInputAmount}}),n("a",{staticClass:"btn btn-empty",on:{click:function(e){t.inputAmount=t.balance}}},[t._v(t._s(t.$t("最大")))])]),t.showApprove?t._e():n("li",[n("button",{staticClass:"btn",on:{click:t.stake}},[n("s"),n("s"),t._v(t._s(t.$t("质押")))])]),t.showApprove?n("li",[n("button",{staticClass:"btn",on:{click:t.submitApprove}},[n("s"),n("s"),t._v(t._s(t.$t("授权")))])]):t._e()])]),n("div",{staticClass:"title"},[n("h3",[t._v(t._s(t.$t("订单列表")))]),n("span")]),n("div",{staticClass:"contant"},[n("section",{staticClass:"table"},[n("table",[n("thead",[n("tr",[n("td",[t._v("ID")]),n("td",[t._v(t._s(t.$t("质押币种")))]),n("td",[t._v(t._s(t.$t("质押数量")))]),n("td",[t._v(t._s(t.$t("到期时间")))]),n("td",[t._v(t._s(t.$t("操作")))])])]),n("tbody",t._l(t.showRecord,(function(e,a){return n("tr",{key:a},[n("td",[n("b",[t._v(t._s(e.id))])]),n("td",[t._v(t._s("xmast"===t.stakeToken?"XMAST":"MAST-MGP-LP"))]),n("td",[n("span",[t._v(t._s(t._f("toFixed")(t._f("toAmount")(e.amount),8)))])]),n("td",[n("em",[t._v(t._s(t._f("formatTimer")(1e3*e.endTime)))])]),1===e.status?n("td",[n("a",{staticClass:"btn btn-empty",on:{click:function(n){return t.withdraw(e.id)}}},[t._v(t._s(t.$t("提现")))])]):t._e(),2===e.status?n("td",[t._v(t._s(t.$t("未到期")))]):t._e()])})),0)])]),t.totalPage>t.limit?n("Pagination",{attrs:{"prev-text":t.$t("上一页"),"next-text":t.$t("下一页"),"items-per-page":t.limit,"total-items":t.totalPage,mode:"simple"},on:{change:t.showPage},model:{value:t.currentPage,callback:function(e){t.currentPage=e},expression:"currentPage"}}):t._e()],1)])],1)},r=[],o=n("3835"),i=n("1da1"),c=n("ade3"),u=(n("96cf"),n("d3b7"),n("3ca3"),n("ddb0"),n("b680"),n("4de4"),n("d81d"),n("fb6a"),n("ee7a")),d=n("901e"),m=n.n(d),l=(n("ed08"),n("c1df"),{name:"Stake",components:{Notify:u["a"]},watch:(a={},Object(c["a"])(a,"$store.state.walletAddress",(function(){this.init()})),Object(c["a"])(a,"$route",(function(){this.stakeToken=this.$route.query.coin})),Object(c["a"])(a,"stakeToken",(function(){this.init()})),a),data:function(){return{tab:"stake",inputAmount:"",showApprove:!0,balance:"0",withdrawAmount:"0",mgpIncome:"0",mastIncome:"0",stakeToken:"xmast",record:[],total:0,totalPage:0,currentPage:1,limit:5,showRecord:[]}},methods:{updateInputAmount:function(t){this.inputAmount=t.target.value},init:function(){var t=arguments,e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,s,r,i,c,u;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:if(a=!(t.length>0&&void 0!==t[0])||t[0],a&&e.$loading.show(),n.prev=2,!e.$store.state.walletConnect){n.next=20;break}return s=e.$api.getConnect(),n.next=7,Promise.all(["xmast"===e.stakeToken?s.erc20().getBalanceAndApprove(s.addressInfo.xmastStake,s.addressInfo.xmast,e.$store.state.walletAddress):s.erc20().getBalanceAndApprove(s.addressInfo.mastUsdtLpStake,s.addressInfo.mastUsdtLP,e.$store.state.walletAddress),s.tradeApi().stakeInfo(e.stakeToken,e.$store.state.walletAddress)]);case 7:r=n.sent,i=Object(o["a"])(r,2),c=i[0],u=i[1],e.showApprove=c.showApprove,e.balance=c.amount,e.withdrawAmount=new m.a(u.userStake).div(1e18).toFixed(),e.mgpIncome=u.income[0],e.mastIncome=u.income[1],e.record=u.userDeposits.map((function(t){var e={amount:t.amount,endTime:t.endTime,id:t.id};return 0===new m.a(t.amount).comparedTo("0")?e.status=3:new m.a(t.endTime).comparedTo(u.blockTime)>0?e.status=2:e.status=1,e})).filter((function(t){return 3!==t.status})),e.total=e.record.length,e.showPage();case 20:return n.prev=20,a&&e.$loading.hide(),n.finish(20);case 23:case"end":return n.stop()}}),n,null,[[2,,20,23]])})))()},showPage:function(){this.totalPage=this.record.length;var t=(this.currentPage-1)*this.limit;this.showRecord=this.record.slice(t,t+this.limit)},submitApprove:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$loading.show(),e.prev=1,n=t.$api.getConnect(),"xmast"!==t.stakeToken){e.next=9;break}return e.next=6,n.erc20().approve(n.addressInfo.xmastStake,n.addressInfo.xmast);case 6:e.t0=e.sent,e.next=12;break;case 9:return e.next=11,n.erc20().approve(n.addressInfo.mastUsdtLpStake,n.addressInfo.mastUsdtLP);case 11:e.t0=e.sent;case 12:return a=e.t0,t.$refs.notify.show(a.getHash()),e.next=16,a.confirm();case 16:return t.$toast(t.$t("授权成功")),e.next=19,t.init();case 19:e.next=24;break;case 21:e.prev=21,e.t1=e["catch"](1),t.$toast(e.t1.message);case 24:return e.prev=24,t.$loading.hide(),e.finish(24);case 27:case"end":return e.stop()}}),e,null,[[1,21,24,27]])})))()},stake:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$loading.show(),e.prev=1,t.$utils.isNumber(t.inputAmount)&&!(new m.a(t.inputAmount).comparedTo(t.balance)>0)){e.next=4;break}throw new Error(t.$t("请检查输入值"));case 4:return n=t.$api.getConnect(),e.next=7,n.tradeApi().stakeStaking(t.stakeToken,new m.a(t.inputAmount).multipliedBy(1e18).toFixed(0,m.a.ROUND_DOWN));case 7:return a=e.sent,t.$refs.notify.show(a.getHash()),e.next=11,a.confirm();case 11:return t.$toast(t.$t("质押成功")),e.next=14,t.init();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](1),t.$toast(e.t0.message);case 19:return e.prev=19,t.$loading.hide(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,16,19,22]])})))()},claim:function(){var t=this;return Object(i["a"])(regeneratorRuntime.mark((function e(){var n,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.$loading.show(),e.prev=1,!(new m.a(t.mastIncome).comparedTo(0)<=0&&new m.a(t.mgpIncome).comparedTo(0)<=0)){e.next=4;break}throw new Error(t.$t("不能领取"));case 4:return n=t.$api.getConnect(),e.next=7,n.tradeApi().stakeClaim(t.stakeToken);case 7:return a=e.sent,t.$refs.notify.show(a.getHash()),e.next=11,a.confirm();case 11:return t.$toast(t.$t("领取成功")),e.next=14,t.init();case 14:e.next=19;break;case 16:e.prev=16,e.t0=e["catch"](1),t.$toast(e.t0.message);case 19:return e.prev=19,t.$loading.hide(),e.finish(19);case 22:case"end":return e.stop()}}),e,null,[[1,16,19,22]])})))()},withdraw:function(t){var e=this;return Object(i["a"])(regeneratorRuntime.mark((function n(){var a,s;return regeneratorRuntime.wrap((function(n){while(1)switch(n.prev=n.next){case 0:return e.$loading.show(),n.prev=1,a=e.$api.getConnect(),n.next=5,a.tradeApi().stakeWithdraw(e.stakeToken,t);case 5:return s=n.sent,e.$refs.notify.show(s.getHash()),n.next=9,s.confirm();case 9:return e.$toast(e.$t("提币成功")),n.next=12,e.init();case 12:n.next=17;break;case 14:n.prev=14,n.t0=n["catch"](1),e.$toast(n.t0.message);case 17:return n.prev=17,e.$loading.hide(),n.finish(17);case 20:case"end":return n.stop()}}),n,null,[[1,14,17,20]])})))()}},mounted:function(){this.stakeToken=this.$route.query.coin,this.init()},created:function(){return Object(i["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)})))()}}),p=l,f=n("2877"),h=Object(f["a"])(p,s,r,!1,null,"70d4188a",null);e["default"]=h.exports}}]);